<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>조달계획등록</title>
    <link rel="stylesheet" href="/css/procurement.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" />
    <link rel="icon" href="/image/favicon-32x32.png">
    <script src="/js/jquery-3.7.1.min.js"></script>
</head>
<body>
<th:block th:replace="~{/fragments/fragment1}"></th:block>

  <div class="container">
      <th:block th:replace="~{/fragments/fragment2}"></th:block>
   <!--   <nav class="sidebar">
          <ul>
              <li><a th:href="@{/index}">메인화면</a></li>
              <li>
                  <a href="#">조달관리 <i class="fas fa-caret-down"></i></a>
                  <ul class="dropdown">
                      <li><a th:href="@{/item/register}">품목정보등록</a></li>
                      <li><a th:href="@{/contract/register}">계약 등록</a></li>
                      <li><a th:href="@{/procurement/procurement}">조달계획등록</a></li>
                  </ul>
              </li>
              <li>
                  <a href="#">발주관리 <i class="fas fa-caret-down"></i></a>
                  <ul class="dropdown">
                      <li><a th:href="@{/purchase_order/purchase_order}">구매 발주서 관리</a></li>
                      <li><a th:href="@{/progress-check}">진척 검수 처리</a></li>
                      <li><a th:href="@{/po-status}">발주 진행 현황</a></li>
                  </ul>
              </li>
              <li>
                  <a href="#">자재관리 <i class="fas fa-caret-down"></i></a>
                  <ul class="dropdown">
                      <li><a th:href="@{/templates/receive}">자재 입출고</a></li>
                      <li><a th:href="@{/invoicing/invoicing}">거래 명세서 발행</a></li>
                      <li><a th:href="@{/inventory}">재고 산출</a></li>
                      <li><a th:href="@{/inventory-management}">재고(금액) 관리</a></li>
                  </ul>
              </li>
          </ul>
      </nav>-->

    <div class="content">
        <div class="registration-section">
          <h2>조달계획등록</h2>
            <form action="/procurement/submit_procurement_plan" method="POST">
            <table class="reg-sec">
              <tr>
                  <th>생산시작일</th>
                  <th>생산종료일</th>
                  <th>생산제품코드</th>
                  <th>생산제품명</th>
                  <th>생산수량</th>
                  <th>품목코드</th>
                  <th>품목명</th>
                </tr>
                <tr>
                    <td><input type="text" class="input-field" id="reg-prodStartDate" disabled></td>
                    <td><input type="text" class="input-field" id="reg-prodEndDate" disabled></td>
                    <td><input type="text" class="input-field" id="reg-productCode" name="productCode" readonly></td>
                    <td><input type="text" class="input-field" id="reg-productName" disabled></td>
                    <td><input type="text" class="input-field" id="reg-prodQuantity" disabled></td>
                    <td><input type="text" class="input-field" id="reg-itemCode" name="itemCode" readonly></td>
                    <td><input type="text" class="input-field" id="reg-itemName" disabled></td>
                </tr>

          </table>
          <table class="save-section">
              <tr>
                  <th>조달수량</th>
                  <th>조달납기일</th>

              </tr>
              <tr>
                  <td><input type="text" class="input-field" id="reg-procureQuantity" name="procQuantity"></td>
                  <td><input type="datetime-local" class="input-field" id="reg-procureTerm" name="procDuedate" ></td>

              </tr>
              <!-- Add more rows as needed -->
            </table>
            <button type="submit" class="save-button">조달계획 등록</button>
        </form>
      </div>

      <div class="management-section">
        <h2>생산계획조회</h2>
          <div class="search-bar">
            <select name="search-option" id="search-option">
              <option value="품목코드">품목코드</option>
              <option value="생산제품코드">생산제품코드</option>
              <option value="품목명">품목명</option>
              <option value="생산제품명">생산제품명</option>
            </select>
              <input type="text" placeholder="품목코드 검색..." class="search-input">
              <button class="search-button">검색</button>
          </div>
          <table>
              <thead>
                  <tr>
                      <th>생산시작일</th>
                      <th>생산종료일</th>
                      <th>생산제품코드</th>
                      <th>생산제품명</th>
                      <th>생산수량</th>
                      <th>품목코드</th>
                      <th>품목명</th>
                      <th>조달계획등록</th>
                  </tr>
              </thead>
              <tbody>
              <!-- 반복문을 통해 서버에서 받아온 데이터를 동적으로 표시 -->
              <tr th:each="productionPlan : ${productionPlans}">
                  <td th:text="${productionPlan.prodStartDate}"></td>
                  <td th:text="${productionPlan.prodEndDate}"></td>
                  <td th:text="${productionPlan.product != null ? productionPlan.product.productCode : 'N/A'}"></td>
                  <td th:text="${productionPlan.product != null ? productionPlan.product.productName : 'N/A'}"></td>
                  <td th:text="${productionPlan.prodQuantity}"></td>
                  <td th:text="${productionPlan.item != null ? productionPlan.item.itemCode : 'N/A'}"></td>
                  <td th:text="${productionPlan.item != null ? productionPlan.item.itemName : 'N/A'}"></td>

                  <td>
                      <button class="register-button"
                              th:data-prod-start-date="${productionPlan.prodStartDate}"
                              th:data-prod-end-date="${productionPlan.prodEndDate}"
                              th:data-product-code="${productionPlan.product != null ? productionPlan.product.productCode : 'N/A'}"
                              th:data-product-name="${productionPlan.product != null ? productionPlan.product.productName : 'N/A'}"
                              th:data-prod-quantity="${productionPlan.prodQuantity}"
                              th:data-item-code="${productionPlan.item != null ? productionPlan.item.itemCode : 'N/A'}"
                              th:data-item-name="${productionPlan.item != null ? productionPlan.item.itemName : 'N/A'}">
                          등록
                      </button>
                  </td>
              </tr>
              </tbody>
          </table>
          <div class="pagination">
              <button class="pagination-button">이전</button>
              <span>1/10 페이지</span>
              <button class="pagination-button">다음</button>
          </div>
      </div>
    </div>
  </div>
  <script src="/js/procurement.js"></script>
  <script src="/js/index.js"></script>
  <script>
      $(document).ready(function() {
          $('.register-button').on('click', function() {
              var prodStartDate = $(this).data('prod-start-date');
              var prodEndDate = $(this).data('prod-end-date');
              var productCode = $(this).data('product-code');
              var productName = $(this).data('product-name');
              var prodQuantity = $(this).data('prod-quantity');
              var itemCode = $(this).data('item-code');
              var itemName = $(this).data('item-name');

              // 입력 필드에 데이터 설정
              $('#reg-prodStartDate').val(prodStartDate);
              $('#reg-prodEndDate').val(prodEndDate);
              $('#reg-productCode').val(productCode);
              $('#reg-productName').val(productName);
              $('#reg-prodQuantity').val(prodQuantity);
              $('#reg-itemCode').val(itemCode);
              $('#reg-itemName').val(itemName);
          });
      });
  </script>
</body>
</html>